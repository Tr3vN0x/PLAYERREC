<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Survival Evolved: Sprite Edition</title>
    <style>
        body { margin: 0; background: #050508; overflow: hidden; font-family: 'Segoe UI', sans-serif; }
        canvas { display: block; }
        #overlay { position: absolute; top: 20px; left: 20px; color: white; pointer-events: none; }
        .bar { width: 200px; height: 10px; background: rgba(0,0,0,0.5); border: 1px solid #444; margin: 5px 0; }
        #hp { width: 100%; height: 100%; background: #ff416c; transition: 0.3s; }
    </style>
</head>
<body>

    <div id="overlay">
        <div style="font-weight: bold; font-size: 20px;">SURVIVOR</div>
        <div class="bar"><div id="hp"></div></div>
        <div id="stamina-ui" style="font-size: 12px; color: #00f2ff;">READY [SHIFT TO DASH]</div>
    </div>

    <canvas id="gameCanvas"></canvas>

<script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    // --- CHARACTER SPRITE ---
    const charSprite = new Image();
    charSprite.crossOrigin = "anonymous"; 
    // Using the girl vector link provided
    charSprite.src = 'https://img.freepik.com/premium-vector/simple-2d-cartoon-character-happy-cute-girl-vector-illustration_1165868-73.jpg?w=900'; 

    const world = { gravity: 0.5, tiles: [] };
    const player = {
        x: 500, y: 300, vx: 0, vy: 0,
        w: 60, h: 100, 
        speed: 5, jump: 12,
        flip: false, 
        dashTimer: 0,
        isAttacking: 0,
        walkCycle: 0
    };

    // Terrain Generation
    for(let x=0; x<500; x++) {
        world.tiles[x] = [];
        let ground = 12 + Math.floor(Math.sin(x*0.1)*3);
        for(let y=0; y<30; y++) {
            if(y > ground) world.tiles[x][y] = (y > ground + 5) ? '#333' : '#5d4037';
        }
    }

    const keys = {};
    window.onkeydown = e => keys[e.code] = true;
    window.onkeyup = e => keys[e.code] = false;

    function update() {
        if(keys['ShiftLeft'] && player.dashTimer === 0) {
            player.vx = player.flip ? -25 : 25;
            player.dashTimer = 40;
        }
        
        if (keys['KeyA']) { 
            player.vx = -player.speed; 
            player.flip = true; 
            player.walkCycle += 0.15;
        } else if (keys['KeyD']) { 
            player.vx = player.speed; 
            player.flip = false; 
            player.walkCycle += 0.15;
        } else { 
            player.vx *= 0.8; 
            player.walkCycle = 0;
        }

        if (keys['Space'] && player.grounded) {
            player.vy = -player.jump;
            player.grounded = false;
        }

        player.vy += world.gravity;
        player.x += player.vx;
        player.y += player.vy;

        let tx = Math.floor(player.x / 40);
        let ty = Math.floor((player.y + player.h/2) / 40);
        if(world.tiles[tx] && world.tiles[tx][ty]) {
            player.y = ty * 40 - player.h/2;
            player.vy = 0;
            player.grounded = true;
        }

        if(player.dashTimer > 0) player.dashTimer--;
        if(player.isAttacking > 0) player.isAttacking--;
    }

    function draw() {
        ctx.fillStyle = '#0a0a15';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        ctx.save();
        ctx.translate(canvas.width/2 - player.x, canvas.height/2 - player.y);

        // Draw World
        for(let x = Math.floor(player.x/40)-20; x < Math.floor(player.x/40)+20; x++) {
            for(let y=0; y<30; y++) {
                if(!world.tiles[x] || !world.tiles[x][y]) continue;
                ctx.fillStyle = world.tiles[x][y];
                ctx.fillRect(x*40, y*40, 40, 40);
                if(world.tiles[x][y-1] == null) {
                    ctx.fillStyle = '#2d8a27'; // Grass
                    ctx.fillRect(x*40, y*40, 40, 6);
                }
            }
        }

        // Draw Character
        ctx.save();
        let bob = Math.sin(player.walkCycle) * 5;
        ctx.translate(player.x, player.y + bob);
        if(player.flip) ctx.scale(-1, 1);
        
        if(charSprite.complete) {
            // Draw a subtle shadow under the girl
            ctx.fillStyle = 'rgba(0,0,0,0.3)';
            ctx.beginPath();
            ctx.ellipse(0, 50-bob, 25, 10, 0, 0, Math.PI*2);
            ctx.fill();

            // Draw the Sprite (Cropped to the character in your link)
            ctx.drawImage(charSprite, 220, 150, 450, 700, -45, -60, 90, 120);

            // Draw Weapon
            ctx.save();
            ctx.translate(10, 0);
            if(player.isAttacking > 0) ctx.rotate(-Math.PI/2);
            ctx.fillStyle = '#00f2ff';
            ctx.shadowBlur = 10; ctx.shadowColor = '#00f2ff';
            ctx.fillRect(0, 0, 40, 6); // Sword Blade
            ctx.fillStyle = '#fff';
            ctx.fillRect(-5, 0, 5, 6); // Handle
            ctx.restore();

        } else {
            // Loading text
            ctx.fillStyle = "white";
            ctx.fillText("LOADING SPRITE...", -40, 0);
        }
        ctx.restore();

        ctx.restore();
        update();
        requestAnimationFrame(draw);
    }

    window.onmousedown = () => player.isAttacking = 15;
    draw();
</script>
</body>
</html>
